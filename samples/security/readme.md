# Application Security Sample Workflows

Here, you can find some examples of how to operationalize security findings, such as vulnerabilities. 

## Getting Started with Security Findings Operationalization

For more information about how the security data is structured, refer to [Security data on Grail](https://docs.dynatrace.com/docs/platform-modules/application-security/security-data-on-grail) documentation.

### Types of security events
* Learn about [security event types](https://docs.dynatrace.com/docs/platform-modules/application-security/security-data-on-grail#security-events) and their structure.
* Events can be generated by Dynatrace capabilities or ingested from third-party tools.

### Approaches for Security Automation
You can trigger a workflow in 2 different ways:
1. Per change event - using the workflow trigger for every new vulnerability event reported on the granularity of the affected entity (for example, vulnerability A per process group B). This approach will trigger immediately as soon as the triggering event appears.
2. Periodical trigger - using the periodical query for events in the past time period. This approach allows you to perform aggregations and a better deduplication of notifications.

## Sample Workflows for Dynatrace-generated Security Events
* `ms_teams_send_critical_vulnerabilities_per_affected_entity.yaml` - MS Teams notification for new critical vulnerabilities per affected entity (static channel assignment).
* `slack_send_critical_vulnerabilities_per_host.yaml` - Slack notification for new critical vulnerabilities aggregated per host (static channel assignment).
* `servicenow_create_ticket_per_host_static_assignment.yaml` - ServiceNow ticket creation for new critical vulnerabilities aggregated per host (static channel assignment).
* `jira_create_ticket_per_host_with_ownership.yaml` - Jira ticket creation for new critical vulnerabilities aggregated per host (ownership-based channel assignment).
* `ocsf_send_critical_vulnerabilities.yaml` - POST an HTTP request to a third-party tool for new critical vulnerabilities in the [Open Cyber Security Format (OCSF)](https://schema.ocsf.io/1.1.0/classes/vulnerability_finding?extensions=linux,win).

## Sample Workflows for Ingested Security Findings
Note: Since the introduction of the Grail security table, up-to-date artifacts are now delivered directly in-product through new integrations.
As a result, the artifacts in this repository are no longer maintained and will become outdated.
For further details, see the [Grail security table migration guide](https://docs.dynatrace.com/docs/secure/threat-observability/migration).

* `jira_tickets_for_critical_container_vulnerabilities.yaml` - Jira ticket creation for new critical container vulnerability findings.
* `slack_notification_for_critical_container_vulnerabilities.yaml` - Slack notification for new critical container vulnerability findings.
* `slack_notifications_for_critical_vulnerabilities.yaml` - A generic version for Slack notification for new critical vulnerability findings (grouped by object).
* `jira_tickets_for_critical_vulnerabilities.yaml` - A generic version for Jira ticket creation for new critical vulnerability findings (grouped by object).
* `email_for_critical_security_findings.yaml` - A generic Email notification for new critical vulnerability findings (grouped by object).

## Sample Workflow for Threat Detection
This sample workflow serves as an extensible blueprint that can be modified to address additional threat vectors. The demonstrated workflow provides a foundational architecture designed for rapid deployment and iteration. Apart from the DQL query being adjustable the workflow can be extended to e.g., lookup ownership and send notifications, include immediate response actions like deleting pods, and more.

* `kubernetes_service_account_unauthorized_access.yaml` - DQL query aiming to detect potentially compromised K8s service accounts. This sample is part of a comprehensive [documented use case](https://dt-url.net/en230wg). Additional technical specifications, system requirements, and prerequisite configurations are available in the official Dynatrace documentation.
* `send-notifications-for-critical-threat-detection-findings.yaml` - A sample workflow template that is automatically triggered when new threat detection findings are generated. It retrieves ownership information for impacted components and sends notifications containing finding insights via Slack, Microsoft Teams, or email.
    * `threat-detection-finding-notification-sender.yaml` - A sample sub-workflow that handles notification delivery based on the provided input information object.
